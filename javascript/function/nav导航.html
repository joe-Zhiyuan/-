<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>nav导航</title>
    <meta name="viewport" content="maximum-scale=1.0,minimum-scale=1.0,user-scalable=0,
width=device-width,initial-scale=1.0">
    <style>
        html,body,ul,li{
            margin:0;
            padding:0;
        }
        .clear:after{
            content:"\0020";
            display:block;
            height:0;
            clear: both;
        }
        .clear{
            zoom:1;
        }
        header{
            width:100%;
            max-width:1200px;
            margin:0 auto;
        }
        #nav{
            float: left;
        }
        #nav>li{
            float: left;
            text-decoration: none;
            list-style: none;
        }
        #nav>li>a{
            display: block;
            height:80px;
            margin:0 30px;
            line-height:80px;
            text-decoration: none;
            color:#333;
        }
        #navBtn{
            display: none;
            float: right;
            width:40px;
            height:30px;
            margin-top:25px;
            cursor: pointer;
            border-radius: 3px;
            margin-right:20px;
            border:1px solid #e6e6e6;
        }
        #navBtn>span{
            display: block;
            width:25px;
            height:2px;
            margin:6px 7px;
            background: #29d0e1;
        }
        section{
            width:100%;
            height:300px;
            background: #ff4499;
        }
        .logo{
            display: block;
            float: left;
            height:80px;
            line-height:80px;
        }
        .logo>img{
            vertical-align: middle;
            height:60px;
        }
        @media screen and (min-width:768px) {
            #nav{
                display: block!important;
            }
        }
        @media screen and (max-width:767px) {
            #nav{
                display: none;
                width:100%;
                background: #d9dada;
            }
            #nav>li{
                width:100%;
            }
            #nav>li>a{
                width:100%;
                height:35px;
                line-height:35px;
                text-indent: 20px;
                margin:0;
            }
            #navBtn{
                display: block!important;
            }
        }
    </style>
</head>
<body>
<header class="clear">
    <a href="" class="logo">
        <img src="../images/logo.png" alt="logo"/>
    </a>
    <div id="navBtn">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
    </div>
    <ul id="nav" class="clear">
        <li><a href="去重.html">去重</a></li>
        <li><a href="放大镜.html">放大镜</a></li>
        <li><a href="图片弹出层.html">图片弹出层</a></li>
        <li><a href="背景破裂效果.html">背景破裂效果</a></li>
    </ul>
</header>
<section>

</section>
<section>
    <ul>
        <li class="til"><a class="fl" href="">一级标签</a><div class="liBtn fr">+</div></li>
        <li class="til"><a class="fl" href="">一级标签</a><div class="liBtn fr">+</div></li>
        <li class="til"><a class="fl" href="">一级标签</a><div class="liBtn fr">+</div></li>
    </ul>
</section>
</body>
<script src="../js/jquery-3.3.1.min.js"></script>
<script type="text/javascript">
    $(document).ready(function(){
        //导航条响应式方法  headerBtn:宽度小于时按钮的id  myNav:导航条的id  thisLiHeight:第一季Li
        // 的高度
        function navTab(headerBtn, myNav, thisLiHeight) {
            // 设置默认值
            var thisLiHeight = thisLiHeight || 35;
            var myNav = $(myNav),
                headerBtn = $(headerBtn),
                myNavHeight,
                //如果二级菜单打开状态，导致高度不对问题
                oldHeight;
            //计算导航条高度
            var lis = myNav.children("li");
            // 获取第一次nav的高度
            myNavHeight = lis.length * thisLiHeight;
            //隐藏导航条方法
            function thisHide() {
                myNav.hide()
            }
            //首页手机端点击显示导航列表
            headerBtn.click(function () {
                //获取导航条的display显示属性
                var navDis = myNav.css("display");
                //根据值判断点击显示隐藏
                if (navDis === "none") {
                    //判断oldHeight上一次隐藏时高度，如果第一次则计算高度，不是第一次使用上一次纪录的高度
                    if(oldHeight > 0){
                        //设置高度为0以显示动画
                        myNav.css("height", "0px");
                        myNav.show();
                        // 如果上一次隐藏的高度小于开始时高度，等于开始时高度
                        if(oldHeight < myNavHeight){
                            oldHeight = myNavHeight;
                        }
                        //防止动画重复执行引发的问题 .stop()
                        myNav.stop().animate({"height": oldHeight + "px"}, 300);
                    }else{
                        //设置高度为0以显示动画
                        myNav.css("height", "0px");
                        myNav.show();
                        myNav.stop().animate({"height": myNavHeight + "px"}, 300);
                    }
                } else if (navDis === "block") {
                    oldHeight = myNav.height();
                    //绑定完成动画时函数，以隐藏导航条
                    myNav.stop().animate({"height": "0px"}, 250, thisHide);
                }
            });
        }
        navTab("#navBtn","#nav");

        // 二级分类显示隐藏方法 tilClass:有二级菜单的一级li的class/id number:执行mouseover 1/click 2 /3专用于有二级菜单
        //sonLiHeight:每个子li的高 sonUlBoxHeight:子ul的padding/margin/border   /4 专用于首页导航有二级菜单
        function childUl(tilClass,number,sonLiHeight,sonUlBoxHeight){
            var sonLiHeight = sonLiHeight || 30;
            var sonUlBoxHeight = sonUlBoxHeight || 0;
            // 导航二级分类
            // 获取有二级ul的li标签
            var navLi = $(tilClass),i,len;
            var flag = true;
            // var event = event || window.event;
            //遍历li标签下的a标签阻止跳转 使展开二级菜单
            var aHrefs = navLi.children("a");

            //遍历li标签在鼠标事件添加效果
            if(number === 1){
                for(i = 0,len = navLi.length;i<len;i++){
                    navLi[i].onmouseenter = function(event){
                        //event=event||window.event 加在这里
                        event = event|| window.event;
                        var thisUl = $(event.target).children("ul");
                        var thisLi = thisUl.children("li");
                        var thisUlWidth = thisLi.length*sonLiHeight + sonUlBoxHeight;
                        thisUl.css("display","block");
                        //解决重复大量执行动画造成崩溃 .stop()
                        thisUl.stop().animate({height:thisUlWidth+"px"},300);
                    };
                    navLi[i].onmouseleave = function(){
                        var thisUl = $(this).children("ul");
                        thisUl.stop().animate({"height":"0px"},250,function(){
                            thisUl.css("display","none");
                        });
                    };
                }
            }else if(number === 2){//点击弹出
                //遍历li标签下的a标签阻止跳转 使展开二级菜单
                for(var z=0;z<aHrefs.length;z++){
                    aHrefs[z].onclick = function(event){
                        event = event|| window.event;
                        event.preventDefault();
                    }
                }
                for (i = 0, len = navLi.length; i < len; i++) {
                    navLi[i].onclick = function (event) {
                        //event=event||window.event 加在这里
                        event = event || window.event;
                        //点击a标签不跳转
                        // event.preventDefault();
                        if (flag) {
                            var thisUl = $(event.target).parent().children("ul");
                            if(thisUl.height() === 0){
                                var thisLi = thisUl.children("li");
                                var thisUlWidth = thisLi.length * sonLiHeight + sonUlBoxHeight;
                                thisUl.css("display", "block");
                                //解决重复大量执行动画造成崩溃 .stop()
                                thisUl.stop().animate({height: thisUlWidth + "px"}, 200);
                            }
                            flag = false;
                        } else {
                            thisUl = $(event.target).parent().children("ul");
                            thisUl.stop().animate({"height": "0px"}, 250, function () {
                                thisUl.css("display", "none");
                            });
                            flag = true;
                        }
                    };
                }
            }else if(number === 3){
                //遍历li标签下的a标签阻止跳转 使展开二级菜单
                for(var z=0;z<aHrefs.length;z++){
                    aHrefs[z].onclick = function(event){
                        event = event|| window.event;
                        event.preventDefault();
                    }
                }
                for (i = 0, len = navLi.length; i < len; i++) {//点击弹出  三级菜单
                    navLi[i].onclick = function (event) {
                        //event=event||window.event 加在这里
                        event = event || window.event;
                        //点击a标签不跳转
                        // this.preventDefault();
                        var headerHigh = $(event.target).parent().parent().height(),
                            thisUl = $(event.target).parent().children("ul"),
                            thisLi = thisUl.children("li"),
                            thisUlWidth = thisLi.length * sonLiHeight + sonUlBoxHeight;
                        if (flag) {
                            thisUl.css("display", "block");
                            //解决重复大量执行动画造成崩溃 .stop()
                            thisUl.stop().animate({height: thisUlWidth + "px"}, 200);
                            $(event.target).parent().parent().stop().animate({"height":headerHigh+thisUlWidth+"px"},200);
                            flag = false;
                        } else {
                            thisUl = $(event.target).parent().children("ul");
                            thisUl.stop().animate({"height": "0px"}, 250, function () {
                                thisUl.css("display", "none");
                            });
                            $(event.target).parent().parent().stop().animate({"height":headerHigh-thisUlWidth+"px"},250);
                            flag = true;
                        }
                    };
                }
            }
        }
    });
</script>
<script>

</script>
</html>