<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>ES6-6-函数扩展</title>
</head>
<body>
    <div id="div"></div>
</body>
<script>
    //函数扩展
    //es5
    function log(x,y){
        // y = y || 'world';
        if(typeof y === 'undefined'){//判断是否被赋值，没有为默认值
            y = 'world';
        }
        console.log(x,y);
    }
    log('hello');//hello world
    log('hello',"china");//hello china
    log('hello',"");//hello
    //ES6
    function log1(x,y = 'world'){
        console.log(x,y);
    }
    log1('hello');//hello world
    log1('hello',"china");//hello china
    log1('hello',"");//hello
    function foo(x = 5){
        // let x = 10; error  默认声明，不能再次声明
    }
    // function foo1(x,x){//error 函数不能有同名参数

    // }
    let x = 99;
    function foo2(p = x +1){
        console.log(p);
    }
    foo2();//100
    x = 101;
    foo2();//102    参数每次都会重新计算
    //与解构赋值结合使用
    function fetch(url,{body = '',method = 'GET',headers={} }){
        console.log(method);
    }
    fetch("www.example.com",{});//GET
    // fetch("www.example.com");//报错 body` of 'undefined' or 'null'
    function fetch2(url,{body = '',method = 'GET',headers={} }= {}){
        console.log(method);
    }
    fetch2("www.example.com");//GET  第二个参数为空，默认值生效
    //参数默认值的位置  位置在尾部，传入undefined触发默认值，null不行
    function f(x = 1,y){
        console.log(x,y);
    }
    f();//1,undefined
    f(2);//2,undefined
    // f(,2);//报错
    f(undefined,2);//1  2
    //函数length属性    返回没有指定默认值参数的个数，如果指定了默认值将不再算入其中，计算的是预期传入的参数个数
    console.log(function(a){}.length);//1
    console.log(function(a = 5){}.length);//0
    console.log(function(a,b,c = 5){}.length);//2
    //作用域       参数的作用域大于函数内变量小于函数外变量
    // let x = 101;
    function f2(y = x){
        let x = 2;
        console.log(y);
    }
    f2();//101
    function f3(y = x2){
        let x = 2;
        console.log(y);
    }
    // f3();//error x2 is not defined
    // var x3 = 1;
    // function foo(x3 = x3){
    //
    // }
    // foo(); error x3 is not defined
    let foo1 = 'outer';
    function bar(func = x => foo1){
        let foo1 = 'inner';
        console.log(func());
    }
    bar();//outer
    var x4 = 1;
    function foo3(x,y = function(){x = 2;}){
        x = 3;
        y();
        console.log(x);
    }
    foo3();//2
    console.log(x4);//1
    //应用
    function throwIfMissing(){
        throw new Error('Missing parameter');
    }
    function foo5(mustBeProvided = throwIfMissing()){
        return mustBeProvided;
    }
    // foo5();//Error('Missing parameter');
    //参数设置为undefined表示这个参数是可以被省略的
    function foo4(optional = undefined){
        console.log(optional);
    }
    foo4();//undefined
    //rest参数    ...变量名   不需要arguments对象
    function add(...values){
        let sum = 0;
        for(var val of values){
            sum +=val;
        }
        return sum;
    }
    console.log(add(1,2,3));//6
    //rest参数改写数组push方法
    function push(array, ...items){
        items.forEach(function(item){
            array.push(item);
            console.log(item);
        });
    }
    var a = [];
    push(a,1,2,3,"dasd");//参数   第一个参数是数组
    //严格模式
    //ES5内部设置严格模式
    function doSomething(a,b){
        'use strict';

    }
    //ES^使用默认值，解构赋值，扩展运算符，不能显式设置为严格模式
    //两种方式
    //1.设置全局严格模式
    //2.把函数包在一个立即执行的无参数的函数里
    const doSomething1 = (function(){
        'use strict';
        return function(value = 42){
            return value;
        };
    }());
    //name属性
    function foo6(){}
    console.log(foo6.name);//foo6
    //ES6   如果将一个匿名的函数赋值给一个变量，ES6的name属性将返回实际的函数名
    var f5 = function(){};
    console.log(f5.name);//f5
    //具名函数  有名字的函数，ES5,ES6都将返回原本的名字
    var f6 = function f7(){};
    console.log(f6.name);//f7
    //Function构造函数返回的实例，将返回anonymous
    console.log((new Function).name);//anonymous
    //bind返回的函数，name属性加上bound前缀
    function foo8(){};
    console.log(foo8.bind({}).name);//bound foo8

    //箭头函数 =>
    var f = v => v;
    // var f = function(v){ 相等
    //     return v;
    // }
    var f = () => 5;//如果不需要参数就用（）代替参数部分
    //如果直接返回对象，必须在对象上面加上()
    const full = ({first,last}) => first+" "+lase;
    // function full(person){
    //     return person.first+" "+person.last;
    // }    相等
    const isEven = n => n % 2 === 0;//是不是偶数
    const square = n => n * n;//乘方
    console.log(isEven(3));//false
    console.log(square(4));//16
    //简化回调函数
    [1,2,3].map(function(x){
        return x * x;
    });
    //箭头函数写法
    [1,2,3].map(x => x*x);
    //返回数组
    const numbers = (...nums) => nums;
    console.log(numbers(1,2,3,4,5));//[1,2,3,4,5]
    //注意事项
    //1.箭头函数的this是固定的，是定义时的对象，而不是使用时的对象
    //有利于封装回调函数  this指向handler
    var handler = {
      id:'123456',
      init:function(){
          document.addEventListener('click',event => this.doSomething(event.type),false);
      },
        doSomething:function(type){
          console.log("handler"+type+"for"+this.id);
        }
    };
    handler.init();//"handler"+click+"for"+123456

    // import * as myFun from "../function/查找排序.html";
    // var arr = [132,1,23,1,3,14,14,5,65,13,54];
    // myFun.bubbleSort(arr);
    // console.log(arr);
</script>
</html>